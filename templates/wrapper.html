{% load static %}
{% load i18n %}
{% load tz %}
{% get_current_language as LANGUAGE_CODE %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" prefix="og: http://ogp.me/ns#">
<head>

    {% block metadata %}

    {% endblock %}

    <meta property="og:site_name" content="{{ fixed.open_graph_site_name }}">
    <meta property="og:title" content="{{ fixed.open_graph_title }}">
    <meta property="og:description" content="{{ fixed.open_graph_description }}">
    <meta property="og:url" content="https://{{ fixed.base }}/{{ LANGUAGE_CODE }}/">
    {% if fixed.open_graph_image %}
        <meta property="og:image" content="{{ fixed.open_graph_image.url }}">
    {% endif %}
    <meta property="og:type" content="website">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="msapplication-TileColor" content="#27ae60">
    <meta name="theme-color" content="#27ae60">
    <meta name="HandheldFriendly" content="true">
    <link rel="shortcut icon" href="{{ MEDIA_URL }}icons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="{{ MEDIA_URL }}icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ MEDIA_URL }}icons/apple-touch-icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="{{ MEDIA_URL }}icons/apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="{{ MEDIA_URL }}icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="{{ MEDIA_URL }}icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="120x120" href="{{ MEDIA_URL }}icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="114x114" href="{{ MEDIA_URL }}icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="76x76" href="{{ MEDIA_URL }}icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="57x57" href="{{ MEDIA_URL }}icons/apple-touch-icon-57x57.png">
    <link rel="stylesheet" href="{% static 'fonts/roboto.min.css' %}">
    <link rel="preload" as="style" href="{% static 'fonts/font-awesome-5.13.0/css/all.min.css' %}"
          onload="this.onload=null;this.rel='stylesheet'">
    <link rel="stylesheet" href="{% static 'css/bootstrap-4.5.0.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/wrapper_styles.css' %}">
    <link rel="preload" as="style" href="{% static 'css/jquery-ui-1.12.1.min.css' %}"
          onload="this.onload=null;this.rel='stylesheet'">

    {% block styles %}

    {% endblock %}

<!-- Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '2984864021793981');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=2984864021793981&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->

</head>
<body class="bg-white">
<div class="scrollable">

    {% block content %}

    {% endblock %}

    <footer class="footer mt-auto" style="background: white">
        <div class="container">
            <div class="d-flex justify-content-between align-items-end">
                <div class="d-block text-left">
                    <a href="#about-us" class="navbar-brand d-block mb-3">
                        <img src="{{ fixed.logo_webp.url }}"
                             onerror="this.onerror=null; this.src='{{ fixed.logo.url }}'"
                             alt="{{ fixed.base }} logo">
                    </a>
                    <a href="#why-us-scroll"
                       class="navigation-link h5 d-block flowing-scroll">{{ wt.why_us }}</a>
                    <a href="#menu"
                       class="navigation-link h5 d-block flowing-scroll">{{ wt.our_menu }}</a>
                    <a href="#reviews"
                       class="navigation-link h5 d-block flowing-scroll">{{ wt.reviews }}</a>
                    <a href="#faq"
                       class="navigation-link h5 d-block flowing-scroll">{{ wt.questions }}</a>
                    <a href="#UserAgreement" data-toggle="modal" data-target="#UserAgreementModal"
                       class="navigation-link h5 d-block">{{ wt.user_agreement }}</a>
                    <a href="#PrivacyPolicy" data-toggle="modal" data-target="#PrivacyPolicyModal"
                       class="navigation-link h5 d-block mb-0">{{ wt.privacy_policy }}</a>
                </div>
                <div class="d-none d-lg-block text-center mx-2">
                    <h4 class="font-weight-bold mb-3">{{ fixed.site_name }}</h4>
                    {% autoescape off %}
                        <h5 class="h5 d-block my-auto">{{ fixed.site_description }}</h5>
                    {% endautoescape %}
                    <h5 class="h5 text-center mt-5 mb-0">Â© 2021 Copyright:
                        <a href="/"> {{ fixed.base|upper }}</a>
                    </h5>
                </div>
                <div class="d-block text-right">
                    <div class="d-flex align-items-center justify-content-end mb-4">
                        <a href="https://wa.me/{{ fixed.whatsapp_number }}" target="_blank" rel="noreferrer"
                           class="mx-1"
                           data-toggle="tooltip" data-placement="left" title="WhatsApp">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                        <a href="https://instagram.com/_u/{{ fixed.instagram_username }}" rel="noreferrer"
                           target="_blank"
                           class="mx-1" data-toggle="tooltip" data-placement="left" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://facebook.com/{{ fixed.facebook_username }}" rel="noreferrer" target="_blank"
                           class="mx-1"
                           data-toggle="tooltip" data-placement="left" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                    </div>
                    <a href="tel:{{ fixed.phone_number }}" class="d-flex align-items-center justify-content-center mb-4"
                       data-toggle="tooltip" data-placement="left" title="{{ wt.call }}">
                        <i class="fas fa-phone mx-2"></i>
                        <h4 class="mb-0">{{ fixed.phone_number }}</h4>
                    </a>
                    <a href="#CallMeModal" class="btn btn-sm default outline mb-0" data-toggle="modal"
                       data-target="#CallMeModal">
                        {{ wt.call_me }}
                    </a>
                </div>
            </div>
            <h5 class="h5 d-block text-center mt-5 mb-2" style="color: #777">{{ wt.footer_info1 }}</h5>
            <h5 class="h5 d-block mb-0 text-center" style="color: #777">{{ wt.footer_info2 }}</h5>
        </div>
    </footer>

</div>

<div class="modal fade" id="UserAgreementModal" tabindex="-1" role="dialog" aria-labelledby="{{ wt.user_agreement }}"
     aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title font-weight-bold" id="UserAgreementModalCenterTitle">{{ wt.user_agreement }}</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <div aria-hidden="true">&times;</div>
                </button>
            </div>
            <div class="modal-body">
                {% autoescape off %}
                    {{ user_agreement.content }}
                {% endautoescape %}
            </div>
            <div class="modal-footer d-flex justify-content-between">
                {% if not user.is_authenticated %}
                    <div class="btn-group">
                        <a href="#LoginModal" class="btn btn-sm red outline d-block" data-toggle="modal"
                           data-target="#LoginModal">{{ wt.logging_in }}</a>
                    </div>
                    <div class="btn-group">
                        <a href="#SignUpModal" class="btn btn-sm default outline d-block" data-toggle="modal"
                           data-target="#SignUpModal">{{ wt.registration }}</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="PrivacyPolicyModal" tabindex="-1" role="dialog" aria-labelledby="{{ wt.privacy_policy }}"
     aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title font-weight-bold" id="PrivacyPolicyModalCenterTitle">{{ wt.privacy_policy }}</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <div aria-hidden="true">&times;</div>
                </button>
            </div>
            <div class="modal-body">
                {% autoescape off %}
                    {{ privacy_policy.content }}
                {% endautoescape %}
            </div>
            <div class="modal-footer d-flex justify-content-between">
                {% if not user.is_authenticated %}
                    <div class="btn-group">
                        <a href="#LoginModal" class="btn btn-sm red outline d-block" data-toggle="modal"
                           data-target="#LoginModal">{{ wt.logging_in }}</a>
                    </div>
                    <div class="btn-group">
                        <a href="#SignUpModal" class="btn btn-sm default outline d-block" data-toggle="modal"
                           data-target="#SignUpModal">{{ wt.registration }}</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="CallMeModal" tabindex="-1" role="dialog" aria-labelledby="{{ wt.call_me }}"
     aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title font-weight-bold" id="CallMeModalCenterTitle">{{ wt.call_me }}</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <div aria-hidden="true">&times;</div>
                </button>
            </div>
            <div class="modal-body">
                <form method="post" action="" id="call-me-form">
                    {% csrf_token %}
                    <label class="text-left d-block">
                        <h4>{{ wt.name_and_surname }}</h4>
                        <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} class="form-control default"
                                                              type="text" name="name" required>
                    </label>
                    <label class="text-left d-block h4" for="#call-me-phone">{{ wt.user_phone }}</label>
                    <div class="input-group text-left d-block">
                        <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} class="form-control default w-100" id="call-me-phone"
                                                              type="text" name="phone" minlength="10" maxlength="150" required>
                        <div class="invalid-feedback mt-0">{{ wt.phone_10_error }}</div>
                    </div>

                    <div class="mt-3 btn-group text-right d-block" style="margin-bottom: 1.8vmax">
                        <button class="btn default" type="submit" id="call-me_btn">{{ wt.send }}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal show fade" id="SpinnerModal" tabindex="-1" role="dialog" aria-labelledby="Loading" aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header"></div>
            <div class="modal-body pt-4 pb-4">
			<svg class="spinner" viewBox="0 0 50 50">
			  <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
			</svg>
    <style>
        .spinner {
  animation: rotate 2s linear infinite;
  z-index: 2;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -25px 0 0 -25px;
  width: 50px;
  height: 50px;
}

  .spinner .path {
    stroke: #00b800;
    stroke-linecap: round;
    animation: dash 1.5s ease-in-out infinite;
  }


@keyframes rotate {
  100% {
    transform: rotate(360deg);
  }
}

@keyframes dash {
  0% {
    stroke-dasharray: 1, 150;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -35;
  }
  100% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -124;
  }
}
    </style>
</div>
            <div class="modal-footer text-right"></div>
        </div>
    </div>
</div>

<div class="modal fade" id="SuccessOrderModal" tabindex="-1" role="dialog"
     aria-labelledby="{{ wt.order_created }}"
     aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title font-weight-bold"
                    id="SuccessOrderModalCenterTitle">{{ wt.order_created }}</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <div aria-hidden="true">&times;</div>
                </button>
            </div>
            <div class="modal-body"></div>
            <div class="modal-footer text-right"></div>
        </div>
    </div>
</div>
<div class="modal fade" id="FailureOrderModal" tabindex="-1" role="dialog"
     aria-labelledby="{{ wt.order_not_created }}"
     aria-hidden="true">
    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title font-weight-bold"
                    id="FailureOrderModalCenterTitle">{{ wt.order_not_created }}</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <div aria-hidden="true">&times;</div>
                </button>
            </div>
            <div class="modal-body"></div>
            <div class="modal-footer text-right"></div>
        </div>
    </div>
</div>
{% if video|length %}
    <div class="modal fade" id="InfoVideoRuModal" tabindex="-1" role="dialog" aria-labelledby="{{ wt.info_video }}"
         aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title font-weight-bold" id="InfoVideoRuModalCenterTitle">{{ wt.info_video }}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <div aria-hidden="true">&times;</div>
                    </button>
                </div>
                <div class="modal-body">
                    {% for vid in video %}
                        <video controls width="100%" height="100%" class="mb-2">
                            {% if vid.video_ru_mp4 %}
                                <source src="{{ vid.video_ru_mp4.url }}" type="video/mp4">
                            {% endif %}
                            {% if vid.video_ru_webm %}
                                <source src="{{ video.video_ru_webm.url }}" type="video/webm">
                            {% endif %}
                            {% if vid.video_ru_ogg %}
                                <source src="{{ vid.video_ru_ogg.url }}" type="video/ogg">
                            {% endif %}
                        </video>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="InfoVideoHeModal" tabindex="-1" role="dialog" aria-labelledby="{{ wt.info_video }}"
         aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title font-weight-bold" id="InfoVideoHeModalCenterTitle">{{ wt.info_video }}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <div aria-hidden="true">&times;</div>
                    </button>
                </div>
                <div class="modal-body">
                    {% for vid in video %}
                        <video controls width="100%" height="100%" class="mb-2">
                            {% if vid.video_he_mp4 %}
                                <source src="{{ vid.video_he_mp4.url }}" type="video/mp4">
                            {% endif %}
                            {% if vid.video_he_webm %}
                                <source src="{{ video.video_he_webm.url }}" type="video/webm">
                            {% endif %}
                            {% if vid.video_he_ogg %}
                                <source src="{{ vid.video_he_ogg.url }}" type="video/ogg">
                            {% endif %}
                        </video>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
{% endif %}

{% if not user.is_authenticated %}
    <div class="modal fade" id="LoginModal" tabindex="-1" role="dialog" aria-labelledby="{{ wt.logging_in }}"
         aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title font-weight-bold" id="LoginModalCenterTitle">{{ wt.logging_in }}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <div aria-hidden="true">&times;</div>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="" id="login-form">
                        {% csrf_token %}
                        <label class="text-left form-group new_login w-100 mt-4 mb-2">
                            <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} class="form-control default"
                                                                  placeholder="{{ wt.email }}" type="email"
                                                                  name="email"/>
                        </label>
                        <label class="text-left form-group w-100 mb-4">
                            <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} class="form-control default"
                                                                  placeholder="{{ wt.password }}" id="id_password"
                                                                  type="password"
                                                                  name="password" required/>
                        </label>
                        <div class="custom-control custom-checkbox">
                            <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} type="checkbox"
                                                                  class="custom-control-input default"
                                                                  id="id_remember" name="remember"
                                                                  checked>
                            <label class="text-left custom-control-label"
                                   for="id_remember">{{ wt.remember_me }}</label>
                        </div>
                        <div class="mt-3 btn-group text-center d-block">
                            <button class="btn default" type="button" id="login_btn">{{ wt.login }}</button>
                        </div>
                        <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} class="form-control default"
                                                              id="next" type="hidden" name="next"
                                                              value="{{ next }}"/>
                    </form>
                </div>
                <div class="modal-footer d-flex justify-content-between">
                    <div class="btn-group">
                        <a href="#ResetPasswordModal" class="btn btn-sm red outline d-block"
                           data-toggle="modal"
                           data-target="#ResetPasswordModal">{{ wt.forget_password }}</a>
                    </div>
                    <div class="btn-group">
                        <a href="#SignUpModal" class="btn btn-sm blue outline d-block" data-toggle="modal"
                           data-target="#SignUpModal">{{ wt.registration }}</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="SignUpModal" tabindex="-1" role="dialog" aria-labelledby="{{ wt.registration }}"
         aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title font-weight-bold" id="SignUpModalCenterTitle">{{ wt.registration }}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <div aria-hidden="true">&times;</div>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="" id="signup-form">
                        {% csrf_token %}
                        <input type="hidden" name="referral_id" class="referral_id">
                        <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} type="hidden" name="username">
                        <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} type="hidden" name="key">
                        <div class="d-none step">1</div>
                        <div class="step-sector step-1">
                            <label class="text-left form-group new_login w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                                                      class="form-control default"
                                                                      placeholder="{{ wt.email }}" type="email"
                                                                      name="email"/>
                            </label>
                            <label class="text-left form-group w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                                                      class="form-control default"
                                                                      placeholder="{{ wt.password }}"
                                                                      type="password"
                                                                      name="password1"/>
                            </label>
                            <label class="text-left form-group w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                                                      class="form-control default"
                                                                      placeholder="{{ wt.repeat_password }}"
                                                                      type="password"
                                                                      name="password2"/>
                            </label>
                            <div class="custom-control custom-checkbox my-3">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} type="checkbox"
                                                                      class="custom-control-input default agreed"
                                                                      name="agreed"
                                                                      checked>
                                {% autoescape off %}
                                    <label class="text-left custom-control-label"
                                           for="agreed">{{ wt.agreed|replace:'$1---><a href="#rules" data-toggle="modal" data-target="#UserAgreementModal">'|replace:'$2---></a>' }}</label>
                                {% endautoescape %}
                            </div>
                        </div>
                        <div class="step-sector step-2" style="display: none">
                            <div class="alert alert-info font-weight-bold text-center mb-3">{{ wt.key_info }}</div>
                            <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} name="key"
                                                                  class="w-100 form-control default" maxlength="6"
                                                                  placeholder="{{ wt.code }}"
                                                                  value="">
                            <div class="my-3 text-center">
                                <a class="code-resend disabled mb-2" href="#" disabled>{{ wt.resend_key }}</a>
                                <div class="m-auto border border-dark rounded-circle text-center timer"
                                     style="height: 40px; width: 40px; display: flex; justify-content: center; align-items: center;"></div>
                            </div>
                        </div>
                        <div class="step-sector step-3" style="display: none">
                            <label class="text-left form-group w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                                                      class="form-control default"
                                                                      placeholder="{{ wt.user_name }}" type="text"
                                                                      name="user_name" maxlength="25"/>
                            </label>
                            <label class="text-left form-group w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                                                      class="form-control default"
                                                                      placeholder="{{ wt.user_surname }}"
                                                                      type="text"
                                                                      name="user_surname" maxlength="25"/>
                            </label>
                            <div class="input-group text-left w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                      class="form-control default"
                                      placeholder="{{ wt.user_phone }}" type="text"
                                      name="user_phone" minlength="10" maxlength="150"/>
                                <div class="invalid-feedback mt-0">{{ wt.phone_10_error }}</div>
                            </div>

                            <label class="text-left form-group w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                                                      class="form-control default"
                                                                      placeholder="{{ wt.user_address }}" type="text"
                                                                      name="user_address" maxlength="150"/>
                            </label>
                            <div class="d-flex align-items-center form-group w-100 my-2">
                                <label class="text-left text-secondary w-100 mb-0 mx-1">{{ wt.user_sex }}:</label>
                                <div class="btn-group btn-group-toggle" role="group" aria-label="{{ wt.user_sex }}">
                                    <button type="button" class="btn user_sex_select blue active">
                                        <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} type="radio"
                                                                              name="user_sex" value="male"
                                                                              autocomplete="off">
                                        <i class="fas fa-male"></i>
                                    </button>
                                    <button type="button" class="btn user_sex_select red">
                                        <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} type="radio"
                                                                              name="user_sex" value="female"
                                                                              autocomplete="off">
                                        <i class="fas fa-female"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="form-group w-100 text-center">
                            <div class="d-flex align-items-center justify-content-around">
                                <button class="btn default" type="button" id="signup_btn">{{ wt.next }}</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <div class="btn-group w-100">
                        <a href="#LoginModal" class="btn btn-sm blue outline w-100" data-toggle="modal"
                           data-target="#LoginModal">{{ wt.logging_in }}</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="ResetPasswordModal" tabindex="-1" role="dialog"
         aria-labelledby="{{ wt.forget_password }}" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title font-weight-bold"
                        id="ResetPasswordCenterTitle">{{ wt.forget_password }}</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <div aria-hidden="true">&times;</div>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="" id="resetpassword-form">
                        {% csrf_token %}
                        <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} type="hidden" name="username">
                        <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} type="hidden" name="key">
                        <div class="d-none step">1</div>
                        <div class="step-sector step-1">
                            <label class="text-left form-group w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                                                      id="resetpassword-form_email"
                                                                      class="form-control default"
                                                                      placeholder="{{ wt.email }}" type="text"
                                                                      name="email"/>
                            </label>
                        </div>
                        <div class="step-sector step-2" style="display: none">
                            <div class="alert alert-info font-weight-bold text-center mb-3">{{ wt.key_info }}</div>
                            <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %} name="key"
                                                                  class="w-100 form-control default" maxlength="6"
                                                                  placeholder="{{ wt.code }}"
                                                                  value="">
                            <div class="my-3 text-center">
                                <a class="code-resend disabled mb-2" href="#" disabled>{{ wt.resend_key }}</a>
                                <div class="m-auto border border-dark rounded-circle text-center timer"
                                     style="height: 25px; width: 25px"></div>
                            </div>
                        </div>
                        <div class="step-sector step-3" style="display: none">
                            <label class="text-left form-group w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                                                      class="form-control default"
                                                                      placeholder="{{ wt.password }}"
                                                                      type="password"
                                                                      name="password1"/>
                            </label>
                            <label class="text-left form-group w-100 my-2">
                                <input {% if LANGUAGE_CODE == 'he' %} dir="rtl" {% endif %}
                                                                      class="form-control default"
                                                                      placeholder="{{ wt.repeat_password }}"
                                                                      type="password"
                                                                      name="password2"/>
                            </label>
                        </div>
                        <div class="form-group w-100 text-center">
                            <div class="d-flex align-items-center justify-content-around">
                                <button class="btn default" type="button"
                                        id="resetpassword_btn">{{ wt.next }}</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer d-flex justify-content-between">
                    <div class="btn-group">
                        <a href="#LoginModal" class="btn btn-sm red outline d-block" data-toggle="modal"
                           data-target="#LoginModal">{{ wt.logging_in }}</a>
                    </div>
                    <div class="btn-group">
                        <a href="#SignUpModal" class="btn btn-sm blue outline d-block" data-toggle="modal"
                           data-target="#SignUpModal">{{ wt.registration }}</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endif %}

{% block modals %}

{% endblock %}

<script src="{% static 'js/jquery-3.5.1.min.js' %}"></script>
<script src="{% static 'js/jquery-ui-1.12.1.min.js' %}"></script>
<script src="{% static 'js/popper-1.16.0.min.js' %}"></script>
<script src="{% static 'js/bootstrap-4.5.0.min.js' %}"></script>
<script>

    $(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });

    $('#signup-form input[name="user_phone"]').on('keyup keydown change', function(e) {
        $(this).removeClass('is-invalid');
        if ($(this).val().length < 10) {
            $('#signup_btn').addClass('disabled').prop('disabled', true);
            $(this).addClass('is-invalid');
        } else {
            $('#signup_btn').removeClass('disabled').prop('disabled', false);
        }
    });

    $('#call-me-form input[name="phone"]').on('keyup keydown change', function(e) {
        $(this).removeClass('is-invalid');
        if ($(this).val().length < 10) {
            $('#call-me_btn').addClass('disabled').prop('disabled', true);
            $(this).addClass('is-invalid');
        } else {
            $('#call-me_btn').removeClass('disabled').prop('disabled', false);
        }
    });

    function change_language(el) {
        if (!$(el).hasClass('active')) {
            var lang = $(el).attr('id').split('-')[1];
            var url_parts = window.location.pathname.split('/');
            url_parts[1] = lang;
            window.location.pathname = url_parts.join('/');
        }
    }

    $('.language-change *').on('click', function () {
        change_language($(this));
    });

    $('.language-change').parent().on('show.bs.dropdown', function(e) {
        $('.calculate-calories').addClass('d-none');
    });

    $('.language-change').parent().on('hide.bs.dropdown', function(e) {
        $('.calculate-calories').removeClass('d-none');
    });

    $('.video').on('click', function(e) {
        e.preventDefault();
        var lang = $(this).data('language');
        $('#InfoVideo' + lang + 'Modal').modal('show');
    });

    $('modal').on('shown.bs.modal', function () {
        if ($(this).find('form').length) {
            $(this).find('form').find('input:visible').first().focus();
        }
    });

    $('html, body').on('keyup', '.modal input', function (e) {
        if (e.keyCode === 13) {
            var form = ($(this).closest('.step-sector').length ? $(this).closest('.step-sector') : $(this).closest('form'));
            var inps = $.merge($.merge(form.find('input[type="text"]:visible'), form.find('input[type="email"]:visible')), form.find('input[type="password"]:visible'));
            var ind = inps.index($(this));
            if (ind === inps.length - 1) {
                $(this).closest('form').submit();
            } else {
                inps[ind + 1].focus();
            }
        }
    });

    $('textarea').each(function () {
        let ta = $(this)[0];
        ta.style.height = ta.scrollHeight + "px";
        ta.addEventListener('keydown', function () {
            if (this.scrollTop >= 0) {
                this.style.height = this.scrollHeight + "px";
            }
        });
        ta.addEventListener('keydown', function () {
            if (this.value.length > 999)
                this.value = this.value.slice(0, 999);
        });
    });

    $('#call-me-form').on('submit', function (event) {
        event.preventDefault();
        $('#call-me-form .alert-success').remove();
        var btn = $('#call-me-form #call-me_btn');
        if (!btn.hasClass('disabled')) {
            btn.addClass('disabled').attr('disabled', true);
            $.ajax({
                url: '/{{ LANGUAGE_CODE }}/call-me/',
                type: 'post',
                data: $('#call-me-form').serialize()
            }).done(function (data) {
                if (data['success']) {
                    $('#call-me-form *').remove();
                    $('#call-me-form').prepend('<div class="alert alert-success" style="margin-bottom: 1.8vmax" role="alert"><strong>{{ wt.success }}</strong><br>{{ wt.call_me_success_info }}</div>');
                } else {
                    $('#CallMeModal').effect('shake');
                    if (!$('#call-me-form .alert-danger').length) {
                        $('#call-me-form').prepend('<div class="alert alert-danger" role="alert"><strong>{{ wt.error }}</strong><br>{{ wt.form_fail_info }}</div>');
                    }
                    btn.removeClass('disabled').attr('disabled', false);
                }
            });
        }
    });

    $('#call-me-form #call-me_btn').on('click', function () {
        var form = $('#call-me-form');
        if (form[0].checkValidity()) {
            form.submit();
        }
    });

    $('.modal').on('show.bs.modal', function (e) {
        var this_modal = $(this);
        $('.modal').each(function (i, el) {
            if ($(el) != this_modal) {
                $(el).modal('hide');
            }
        });
    });

</script>

{% if not user.is_authenticated %}

    <script>

        $(function () {
            if (window.location.hash === '#login') {
                $('#LoginModal').modal('show');
            }
        });

        $('.user_sex_select').on('click', function () {
            $(this).find('input').prop('checked', true);
        });

        $('#login-form #login_btn').on('click', function (event) {
            event.preventDefault();
            $('#login-form .alert-success').remove();
            var btn = $('#login-form #login_btn');
            if (!btn.hasClass('disabled')) {
                btn.addClass('disabled').attr('disabled', true);
                $.ajax({
                    url: '/{{ LANGUAGE_CODE }}/login/',
                    type: 'post',
                    data: $('#login-form').serialize()
                }).done(function (data) {
                    if (data['success']) {
                        $('#login-form *').remove();
                        $('#LoginModal .modal-footer').remove();
                        $('#login-form').prepend('<div class="alert alert-success" style="margin-bottom: 1.8vmax" role="alert"><strong>{{ wt.success }}</strong><br>{{ wt.wait_a_second }}</div>');
                        window.location.pathname += 'user-' + data.id + '/';
                    } else {
                        $('#LoginModal').effect('shake');
                        if (!$('#login-form .alert-danger').length) {
                            $('#login-form').prepend('<div class="alert alert-danger" role="alert"><strong>{{ wt.error }}</strong><br>{{ wt.try_again }}</div>');
                        }
                        btn.removeClass('disabled').attr('disabled', false);
                    }
                });
            }
        });

        function three_steps_form(form_name) {
            var fnl = form_name.toLowerCase();

            function form_success_false(data) {
                $('#' + fnl + '-form .invalid-feedback').remove();
                $('#' + fnl + '-form input').removeClass('is-valid is-invalid');
                $.each(data, function (key, data) {
                    $.each(data, function (index, err) {
                        let inp = $('#' + fnl + '-form input[name="' + key + '"]');
                        inp.addClass('is-invalid');
                        inp.parent().append('<div class="invalid-feedback">' + err + '</div>');
                    });
                });
                $('#' + fnl + '-form input:not(.is-invalid)').addClass('is-valid');
                $('#' + fnl + '-form input.is-invalid').first().focus();
                $('#' + form_name + 'Modal').effect('shake');
            }

            function form_success_true(step) {
                var next_step = parseInt(step) + 1;
                $('#' + fnl + '-form').fadeOut(200, function () {
                    $('#' + fnl + '-form .step-' + step).css('display', 'none');
                    $('#' + fnl + '-form .step-' + next_step).css('display', 'block');
                    $('#' + fnl + '-form input').removeClass('is-valid is-invalid');
                    $('#' + fnl + '-form').fadeIn(200);
                    $('#' + fnl + '-form .step').text(next_step);
                    $('#' + fnl + '-form input').first().focus();
                });
            }

            function generateTimer() {
                const time = $('#' + fnl + '-form .timer');
                time.fadeIn(200);
                time.text('180');
                timerDecrement();

                function timerDecrement() {
                    setTimeout(function () {
                        const newTime = time.text() - 1;
                        time.text(newTime);
                        if (newTime > 0) {
                            timerDecrement();
                        } else {
                            time.fadeOut(200);
                            $('#' + fnl + '-form .code-resend').removeClass('disabled').attr('disabled', false);
                        }
                    }, 1000);
                }
            }

            $('.code-resend').on('click', function (e) {
                e.preventDefault();
                if (parseInt($('#' + fnl + '-form .timer').text()) <= 0 && !$(this).hasClass('disabled')) {
                    $(this).addClass('disabled').attr('disabled', true);
                    $('#' + fnl + '-form .step-2 .alert-danger').fadeOut(200, function () {
                        $(this).remove();
                    });
                    $.ajax({
                        url: '/{{ LANGUAGE_CODE }}/' + fnl + '/step-1/',
                        type: 'post',
                        data: $('#' + fnl + '-form').serialize()
                    }).done(function (data) {
                        if (data['success']) {
                            $('#' + fnl + '-form .code-inputs').before('<div class="alert alert-success my-2" style="display: none">{{ wt.key_resented }}</div>');
                            $('#' + fnl + '-form .step-2 .alert').fadeIn(200);
                            generateTimer();
                        }
                    });
                }
            });

            $('#' + fnl + '-form').on('submit', function (event) {
                let step = parseInt($(this).find('.step').text());
                event.preventDefault();
                var btn = $('#' + fnl + '-form #' + fnl + '_btn');
                if (!btn.hasClass('disabled')) {
                    btn.addClass('disabled').attr('disabled', true);
                    $.ajax({
                        url: fnl + '/step-' + step + '/',
                        type: "post",
                        data: $('#' + fnl + '-form').serialize()
                    }).done(function (data) {
                        if (step === 1) {
                            if (data['success']) {
                                $('#' + fnl + '-form input[name="username"]').val(data['username']);
                                generateTimer();
                                form_success_true(step);
                            } else form_success_false(data);
                        } else if (step === 2) {
                            $('#' + fnl + '-form .step-2 .alert-danger').fadeOut(200, function () {
                                $(this).remove();
                            });
                            if (data['success']) {
                                form_success_true(step);
                                $('#' + fnl + '-form input[name="key"]').val(data['key']);
                            } else {
                                $('#' + fnl + '-form .code-inputs').before('<div class="alert alert-danger my-2">{{ wt.bad_key }}</div>');
                                $('#' + fnl + '-form .code-inputs input').val('');
                                $('#' + fnl + '-form .code-inputs input[name="key"]').focus();
                                $('#' + form_name + 'Modal').effect('shake');
                            }
                        } else {
                            if (data['success']) {
                                $('#' + form_name + ' *').remove();
                                $('#' + form_name).prepend('<div class="alert alert-success" style="margin-bottom: 1.8vmax" role="alert"><strong>{{ wt.success }}</strong><br>{{ wt.wait_a_second }}</div>');
                                window.location.pathname += 'user-' + data.id + '/';
                            } else form_success_false(data);
                        }
                        btn.removeClass('disabled').attr('disabled', false);
                    });
                }
            });

            $('#' + fnl + '-form #' + fnl + '_btn').on('click', function () {
                $('#' + fnl + '-form').submit()
            });
        }

        three_steps_form('SignUp');
        three_steps_form('ResetPassword');

    </script>

{% endif %}

{% block scripts %}

{% endblock %}

</body>
